---
title: "P8105 Homework 3 Solutions"
author: Meghan Bellerose
date: October 1, 2020
output: html_document
---

```{r, message = FALSE}
library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

# Problem 1: Instacart

First, I'll load Instracart data from the p8105 library.

```{r}
library(p8105.datasets)
data("instacart")
```

The Instracart dataset...

There are X aisles. The aisles that most items are ordered from are X, X, and X.


The following plot shows the number of items ordered in each aisle (limited to aisles with more than 1000 items ordered). 

This table shows the three most popular items in the aisles: “baking ingredients”, “dog food care”, and “packaged vegetables fruits” and how many times each item is ordered. 

This table shows the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week.

# Problem 2: Accelerometers 

This problem includes data from an accelerometer dataset including five weeks of accelerometer data collected on a 63 year-old male with a BMI of 25 who was admitted to the Advanced Cardiac Care Center of Columbia University Medical Center and diagnosed with congestive heart failure (CHF).

First, I will load, tidy, and organize the data.

```{r}
accel_data = 
  read_csv("./data/accel_data.csv") %>% 
  pivot_longer(
    activity.1:activity.1440,
    names_to = "minute", 
    names_prefix = "activity.",
    values_to = "activity_count") %>% 
  group_by(day) %>% 
  mutate(
    weekend = day,
    weekend = recode(weekend, "Monday" = "FALSE", "Tuesday" = "FALSE", "Wednesday" = "FALSE", "Thursday" = "FALSE", "Friday" = "FALSE", "Saturday" = "TRUE", "Sunday" = "TRUE"),
    weekend = as.logical(weekend)
  )

head(arrange(accel_data, day_id, week, day, weekend, minute, activity_count))
```

The final accelerometer dataset contains information on the day and week of activity collection, whether the data were collected on a weekend or weekday, and the activity count during each minute of the 24 hour days. Overall, the mean activity count per minute during the 5 week observation period was `r round(mean(pull(accel_data, activity_count)),1)`. The dataset has `r nrow(accel_data)` rows and `r ncol(accel_data)` columns. 

I'll now create a dataset aggregating activity counts over each day and produce a table showing the totals.

```{r}
accel_data %>% 
 group_by (day_id) %>%  
  mutate(
    activity_total = sum(activity_count),
  ) %>% 
  janitor::tabyl(day_id, activity_total)
```


The trends are..

# Problem 3

